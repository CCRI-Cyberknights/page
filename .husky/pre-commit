#!/bin/bash
. "$(dirname -- "$0")/_/husky.sh"

cd "$(dirname -- "$0")/.."

# Check if any HTML files have been modified
if git diff --cached --name-only | grep -q "\.html$"; then
    echo "🔗 HTML files changed - running parallel link tests..."
    . ./testing_env/bin/activate
    python3 scripts/test-links-dynamic-parallel.py
    
    # Check if link testing passed
    if [ $? -eq 0 ]; then
        echo "✅ All links are working correctly. Proceeding with version bump..."
        npm run version:auto
    else
        echo "❌ Link testing failed! Please fix broken links before committing."
        exit 1
    fi
else
    echo "📄 No HTML files changed - skipping link tests"
    npm run version:auto
fi
